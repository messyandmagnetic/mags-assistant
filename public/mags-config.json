{
  "vercel_json": {
    "$schema": "https://openapi.vercel.sh/vercel.json",
    "version": 2,
    "cleanUrls": true
  },

  "code_layout": {
    "static_site": true,
    "has_api_routes": false,
    "notable_files": [
      "vercel.json",
      "package.json",
      ".github/workflows/*",
      "public/mags-config.json"
    ]
  },

  "endpoints": {
    "status_page": "/check",
    "health": "/health",
    "echo": "/api/echo"
  },

  "cloudflare": {
    "worker_url": "https://tight-snow-2840.messyandmagnetic.workers.dev",
    "cron": {
      "enabled": true,
      "hourly": "/cron/hourly",
      "nightly": "/cron/nightly"
    }
  },

  "ops": {
    "status_reporting": {
      "enabled": true,
      "channels": ["GitHub PR comments", "Telegram"]
    },
    "telegram": {
      "enabled": true,
      "bot_token_secret": "TELEGRAM_BOT_TOKEN",
      "chat_id_secret": "TELEGRAM_CHAT_ID",
      "default_prefix": "[Mags]"
    }
  },

  "project": {
    "owner": "messyandmagnetic",
    "repo": "mags-assistant",
    "deployment": {
      "platform": "vercel",
      "prod_url": "https://mags-assistant.vercel.app",
      "vercel_json": {
        "$schema": "https://openapi.vercel.sh/vercel.json",
        "version": 2,
        "cleanUrls": true
      },
      "node_policy": "20.x (project settings) â€” do not override with 22.x"
    },
    "code_layout": {
      "static_site": true,
      "has_api_routes": false,
      "notable_files": [
        "vercel.json",
        "package.json",
        ".github/workflows/*",
        "public/mags-config.json"
      ]
    }
  },

  "github_actions": {
    "workflows": [
      "cron-runner.yml",
      "drive-review.yml",
      "health-check.yml",
      "nightly-analytics.yml",
      "nightly-trends.yml",
      "preview-check.yml",
      "smoke.yml",
      "housekeeping.yml",
      "memory-clean.yml",
      "link-check.yml",
      "ops-fallback.yml",
      "post-windows.yml",
      "stripe-sync.yml"
    ],
    "policy": {
      "dispatchable": true,
      "default_branch": "main",
      "required_permissions": ["contents:write", "pull_requests:write", "actions:read"]
    },
    "skip_rules": {
      "skip_if_api_base_empty": true
    }
  },

  "secrets": {
    "present": [
      "API_BASE",
      "CRON_SECRET",
      "HQ_DATABASE_ID",
      "NOTION_TOKEN",
      "OPENAI_API_KEY",
      "PROD_URL",
      "TELEGRAM_BOT_TOKEN",
      "TELEGRAM_CHAT_ID",
      "USE_GH_CRON",
      "VERCEL_PROD_URL",
      "VERCEL_PROJECT_ID",
      "VERCEL_TOKEN",
      "WORKER_KEY"
    ],
    "maybe_missing": [
      "WORKER_URL",
      "NOTION_DB_TRENDS"
    ],
    "notes": {
      "API_BASE": "Leave blank or point to your worker only if you actually serve API there. Static site means do not call it.",
      "USE_GH_CRON": "Set to 'true' to let GitHub Actions run scheduled jobs; 'false' if Cloudflare/Vercel crons are used.",
      "WORKER_URL": "Cloudflare Worker base URL if different from cloudflare.worker_url."
    }
  },

  "guard_rails": {
    "vercel_json_rules": [
      "No legacy now-* runtimes",
      "No framework key (Vercel auto-detect)",
      "If you add rewrites/redirects/headers/cleanUrls/trailingSlash then do not include routes"
    ],
    "actions_rules": [
      "Workflows that POST to /api/* must be gated because site is static",
      "If API_BASE is empty or not reachable, skip those jobs instead of failing"
    ]
  }
}